if(typeof APA=="undefined"){var APA={}}APA.Toolbox={clearSimulationObjects:function(){APA.Toolbox.objectSelect.descendants().each(Element.remove);APA.Toolbox.objectSelect.hide().disable().insert(new Element("option",{value:""}).update(APA.Toolbox.labels.object))},clearSimulationStates:function(){APA.Toolbox.stateSelect.descendants().each(Element.remove);APA.Toolbox.stateSelect.hide().disable().insert(new Element("option",{value:""}).update(APA.Toolbox.labels.state))},clearSimulationReasons:function(){APA.Toolbox.reasonSelect.descendants().each(Element.remove);APA.Toolbox.reasonSelect.hide().disable().insert(new Element("option",{value:""}).update(APA.Toolbox.labels.reason))},fillSimulationObjects:function(){APA.Toolbox.clearSimulationReasons();APA.Toolbox.clearSimulationStates();APA.Toolbox.clearSimulationObjects();$H(APA.Toolbox.availableSimulations).each(function(a){APA.Toolbox.objectSelect.insert(new Element("option",{value:a.key}).update(a.key))});APA.Toolbox.objectSelect.enable().show();APA.Toolbox.objectSelect.observe("change",function(b){var a=APA.Toolbox.objectSelect.getValue();if(a&&typeof APA.Toolbox.availableSimulations[a]!="undefined"&&typeof APA.Toolbox.availableSimulations[a]["states"]!="undefined"){APA.Toolbox.fillSimulationStates(APA.Toolbox.availableSimulations[a]["states"])}else{APA.Toolbox.clearSimulationReasons();APA.Toolbox.clearSimulationStates()}})},fillSimulationStates:function(a){APA.Toolbox.clearSimulationReasons();APA.Toolbox.clearSimulationStates();$H(a).each(function(b){APA.Toolbox.stateSelect.insert(new Element("option",{value:b.key}).update(b.key))});APA.Toolbox.stateSelect.enable().show();APA.Toolbox.stateSelect.observe("change",function(c){var b=APA.Toolbox.stateSelect.getValue();if(b&&typeof a[b]!="undefined"&&typeof a[b]["reasons"]!="undefined"){APA.Toolbox.fillSimulationReasons(a[b]["reasons"])}else{APA.Toolbox.clearSimulationReasons()}})},fillSimulationReasons:function(a){APA.Toolbox.clearSimulationReasons();$H(a).each(function(b){APA.Toolbox.reasonSelect.insert(new Element("option",{value:b.key}).update(b.key))});APA.Toolbox.reasonSelect.enable().show()},initialize:function(a,b,c){document.observe("dom:loaded",Object.extend(APA.Toolbox,{availableSimulations:a,objectSelect:$(b.object),stateSelect:$(b.state),reasonSelect:$(b.reason),labels:c}).fillSimulationObjects)}};APA.getSaveOrderParams=function(){var a="";if(APA.virtual){if($("checkout-agreements")){a+=Form.serialize($("checkout-agreements"))}}else{a=Form.serialize($("co-shipping-method-form"));if($("checkout-agreements")){a+="&"+Form.serialize($("checkout-agreements"))}}if(APA.reloaded){a+="&"+Object.toQueryString({reloaded:1})}if($("sandbox-simulation")&&$("simulation_object").getValue()){a+="&"+Form.serialize($("sandbox-simulation"))}a.save=true;return a};